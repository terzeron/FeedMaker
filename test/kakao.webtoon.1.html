
	

<input type="hidden" value="" class="isMobile">
<input type="hidden" value="/" class="commonPath">
<input type="hidden" value="" class="imgPath">
<input type="hidden" value="1" class="navi">
<input type="hidden" value="0" class="inkatalk">
<input type="hidden" value="/" class="mainPath">
<input type="hidden" value="" class="tabType">
<input type="hidden" value="10" class="categoryUid">
<input type="hidden" value="115" class="subCategoryUid">
<input type="hidden" value="46818960" class="seriesId">
<input type="hidden" value="W" class="seriesType">
<input type="hidden" value="" class="os">
<input type="hidden" value="" class="viewerShowBackBtn"><form name="move"><input type="hidden" name="productId"></form>
	
	<div class="pcToonViewList">
		<div class="topBar" style="display: block;">
			<h1 class="lg_pc"><a href="/today" style="height:auto"><img src="/resources/kakaopage/v3.0.0/images/lg_kakaopage_pc.jpg" alt="lg_kakaopage_px" width="123"></a></h1>
			<span class="title ellipsis_hd">168화 무서운 거</span>
			<span class="btnWrp">
				<a href="/today" class="home goMain">홈</a>
				<a href="/home/46818960?categoryUid=10&amp;subCategoryUid=115" class="list _goLinkListBtn" data-seriesid="46818960">목록</a>
				<a href="#" class="pc_view_prev" data-previous="47710701">이전편</a>
				<a href="#" class="pc_view_next" data-next="0">다음편</a>
			</span>
		</div>

		<ul class="webToonArea">
			<li><img src="http://dn-img-page.kakao.com/download/resource?kid=d2I0zO/hybnAWhZ2I/J4C3Thl51rpQuU0Sn0G1I0&amp;filename=1439861851019_img.jpg" class="targetImg" data-original="http://dn-img-page.kakao.com/download/resource?kid=d2I0zO/hybnAWhZ2I/J4C3Thl51rpQuU0Sn0G1I0&amp;filename=1439861851019_img.jpg" width="760"></li>
			<li><img src="http://dn-img-page.kakao.com/download/resource?kid=Ajcao/hybnERWhZV/XLNu2DPh9UHhikibejekb0&amp;filename=1439861851259_img.jpg" class="targetImg" data-original="http://dn-img-page.kakao.com/download/resource?kid=Ajcao/hybnERWhZV/XLNu2DPh9UHhikibejekb0&amp;filename=1439861851259_img.jpg" width="760"></li>
			<li><img src="http://dn-img-page.kakao.com/download/resource?kid=BxplX/hybnFwtRR5/Wl3kOOb0UvZJxHE6apeptK&amp;filename=1439861851394_img.jpg" class="targetImg" data-original="http://dn-img-page.kakao.com/download/resource?kid=BxplX/hybnFwtRR5/Wl3kOOb0UvZJxHE6apeptK&amp;filename=1439861851394_img.jpg" width="760"></li>
			<li><img src="http://dn-img-page.kakao.com/download/resource?kid=pZaBi/hybnBARf18/zy8WaKsR0BWdt2rnVXScgk&amp;filename=1439861851518_img.jpg" class="targetImg" data-original="http://dn-img-page.kakao.com/download/resource?kid=pZaBi/hybnBARf18/zy8WaKsR0BWdt2rnVXScgk&amp;filename=1439861851518_img.jpg" width="760"></li>
			</ul>
	</div>
	
	<hr>
	
	<input type="hidden" value="46818960" class="seriesId">
	<input type="hidden" value="1" class="navi">
	<input type="hidden" value="0" class="inkatalk">
	<input type="hidden" value="/" class="mainPath">
	
	<div id="footer" class="footer " style="visibility:visible;">
	<span class="copyrightArea">
		Copyright © <a href="http://daumkakao.com/" target="_blank" class="link_daumkakao" style="font-weight:bold;color:#666">Daum Kakao Corp.</a> All rights reserved.
	</span>
</div><hr>
	
	<div class="dimmedBgWrp" style="display: block; height: 4758px;"></div>
	<div class="viewingInfo" style="position: absolute; left: 50%; z-index: 99999; margin-left: -87px; top: 82.5px;">
		<img src="/resources/kakaopage/v3.0.0/images/icon_scrollInfo.png" alt="스크롤">
	</div>
	<div class="dimmedContentPos" style="top: 82.5px;">
		<span class="dimmed_text"></span>
		<a href="#"><img src="/resources/webApp/images/btn_viewConfirm.jpg" alt="btn_viewConfirm" class="btn_viewConfirm"></a>
	</div>
	
	<div class="ajax_loader" style="text-align: center; position: absolute; left: 50%; margin-left: -20px; top: 172px; display: none;"><img src="/resources/kakaopage/v3.0.0/images/ajax-loader.gif" alt="ajax-loader" width="40"></div>
	<script type="text/javascript">
(function() {
	function switchPc() {
		this.topBar = $('.topBar');
		this.target = $('.targetImg');
		this.next = $('.pc_view_next');
		this.prev = $('.pc_view_prev');
		this.viewConfirm = $('.btn_viewConfirm');
		this.bgWrp = $('.dimmedBgWrp');
		this.dimmedTarget = $('.dimmedContentPos');
		this.targetH = parseInt(this.dimmedTarget.css('height'));
		/* this.windowH = parseInt(window.screen.height); */
		this.windowH = $(window).height();
		this.wheelSpeed = null;
		this.docH = null;
		this.scrollPos = null;
		this.categoryUid = $('.categoryUid').val();
		this.subCategoryUid = $('.subCategoryUid').val();
	}
	
	switchPc.prototype = {
		/** 
		 * 스크롤 값 초기화
		 */
		scrollInit : function(e) {
			var documentHeight = $(document).height();
			this.scrollPos = $(window).scrollTop();
			
			
			if(this.scrollPos < 0) {
				this.scrollPos = 0;
			}
			if(this.scrollPos > documentHeight) {
				this.scrollPos = documentHeight;
			}
			
			if(e.type == 'load') {
				this.docH = $(document).height();
				this.loadScrollPos(this.scrollPos);
				this.dimmedBg();
				this.posCalculte();
			}
			
			if(e.type == 'scroll') {
				if(this.wheelSpeed == null) {
					this.topBar.css('display', 'none');	
				}
				this.scrollCheck(this.scrollPos, documentHeight);
				this.dimmedBg();
				this.posCalculte();
				this.docH = $(document).height();
				this.showTopBarAction();
			}
		},
		/**
		 * 스크롤 값이랑 위치 잡기.
		 */
		scrollCheck : function(_scrollPos, _documentHeight) {
			if(_scrollPos > 60) {
				this.hideTopBar();
			}else{
				this.showTopBar();
			}
		},
		
		loadScrollPos : function(_scrollPos) {
			if(_scrollPos < 60) {
				this.showTopBar();
			}
		},
		
		/**
		 * 탑바 숨김.
		 */
		hideTopBar : function() {
			this.topBar.slideUp(0);
		},
		 
		 /** 
		  * 탑바 노출.
		  */
		showTopBar : function() {
			this.topBar.slideDown(0);
		},
		
		dimmedBg : function() {
			this.bgWrp.css('height', this.docH + 'px');
		},
		
		posCalculte : function() {
			this.windowH = $(window).height();
			var targetPos = (this.scrollPos + (this.windowH - this.targetH) / 2);
			/* console.log("스크롤 위치 : " + this.scrollPos + " / 윈도우 높이 : " + this.windowH + " / 타켓높이 : " + this.targetH + " / 현재 타켓 top : " + targetPos); */
			this.dimmedTarget.css('top', targetPos);
			$('.viewingInfo').css('top', targetPos);
		},
		
		firstViewer : function(t) {
			$('.dimmed_text').text(t);
			$('.dimmedBgWrp').show();
			$('.dimmedContentPos').show();
			$('body').css("overflow", "hidden");
		},
		
		lastViewer : function(t) {
			$('.dimmed_text').text(t);
			$('.dimmedBgWrp').show();
			$('.dimmedContentPos').show();
			$('body').css("overflow", "hidden");
		},
		
		pageMove : function(uid, isNext) {
			if(uid == 0) {
				this.pageCheck(uid, isNext);
				return false;
			}
			location.href = "/viewer?productId=" + uid + "&categoryUid=" + this.categoryUid + "&subCategoryUid=" + this.subCategoryUid;
			return false;
		},
		
		pageCheck : function(_uid, _isNext) {
			if(_isNext) {
				var text = "마지막편입니다.";
				this.lastViewer(text);
				this.next.removeClass('activeNext');
			} else {
				var text = "첫편입니다.";
				this.firstViewer(text);
				this.prev.removeClass('activePrev');
			}
			return false;
		},
		
		showTopBarAction : function() {
			
			var win = $(window);
			var doc = $(document);
			var scrollTop = win.scrollTop();
			var winH = win.height();
			var docH = doc.height();
			var space = 100;
			var showScrollTop = scrollTop + winH + space;
			
			if(showScrollTop > docH) {
				this.showTopBar();
			} else if(scrollTop < space) {
				this.showTopBar();
			}else {
				this.hideTopBar();
			}
		}
	};
	
	switchPc.prototype.constructor = switchPc;
	
	var pcToon = new switchPc();

	window.onmousewheel = function(event) {
		pcToon.wheelSpeed = Math.abs(event.wheelDelta);
	};
	
	$(window).on('scroll', function(e) {
		pcToon.scrollInit(e);
	});
	
	$(window).on('load', function(e) {
		pcToon.scrollInit(e);
	});
	
	pcToon.target.on('click', function() {
		pcToon.showTopBar();
		return false;
	});
	
	pcToon.next.on('click', function() {
		pcToon.pageMove($(this).attr("data-next"), true);
		return false;
	});
	
	pcToon.next.on('mouseenter', function() {
		pcToon.next.addClass('activeNext');
		return false;
	});
	
	pcToon.next.on('mouseleave', function() {
		pcToon.next.removeClass('activeNext');
		return false;
	});
	
	pcToon.prev.on('click', function() {
		pcToon.pageMove($(this).attr("data-previous"), false);
		return false;
	});
	
	pcToon.prev.on('mouseenter', function() {
		pcToon.prev.addClass('activePrev');
		return false;
	});
	
	pcToon.prev.on('mouseleave', function() {
		pcToon.prev.removeClass('activePrev');
		return false;
	});
	
	pcToon.viewConfirm.on('click', function() {
		$('.dimmedBgWrp').hide();
		$('.dimmedContentPos').hide();
		$('body').css("overflow", "auto");
		return false;
	});
	
	var top_home = $('.home');
	var top_list = $('.list');
	
	top_home.on('mouseenter', function() {
		top_home.addClass('activeHome');
	});
	
	top_home.on('mouseleave', function() {
		top_home.removeClass('activeHome');
	});
	
	top_list.on('mouseenter', function() {
		top_list.addClass('activeList');
	});
	
	top_list.on('mouseleave', function() {
		top_list.removeClass('activeList');
	});
	
	/**
	* @ 목록으로 이동
	*/
	/* $(".goListBtn").click(function () {
		var _this = $(this);
		var seriesId =_this.attr("data-seriesid");
		var rootPath = $(".rootPath").val();
		location.href = rootPath + "link/" + seriesId;
		return false;
	}); */
}(jQuery));

(function () {
	var targetImg = $(".targetImg");
	var targetWrp = $(".targetWrp");
	var targetImgSize = targetImg.length;
	var targetWrpSize = targetWrp.length;
	var unit  = 10;
	var currentPage = 0;
	var isAvailable = true;
	var operation= false;
	var sensitive = 0.15;
	var loader = $('.ajax_loader');
	var win = $(window);
	var scrollPosY = win.scrollTop();
	
	if(targetImgSize <= unit)
		isAvailable = false;
	
	function viewAction(offset, limit){
		var len = limit + offset;
		
		for(var i = offset; i < len ; i++) {
			if (len > targetImgSize)
				len = targetImgSize;
			targetImg.eq(i).attr("src", targetImg.eq(i).attr("data-original"));
		}
		
		if(currentPage < targetImgSize){
			currentPage += unit;
			if(len < unit) {
				setTimeout(function() {
					$('.preload').removeClass('preload');
					$('.controlBtnWrp').show();
					$('.appDownWrp').css("visibility", "visible");
				}, 1000);
			}
			/* console.log("currentPage : " + currentPage + " / offset : " + offset + " / limit : " + limit + " / len : " + len); */
		} else {
			//console.log("stop!"); 
			isAvailable = false;
				$('.preload').removeClass('preload');
				$('.controlBtnWrp').show();
				$('.appDownWrp').css("visibility", "visible");
		}
	
		operation = false;
	}
	
	function imgStateCheck() {
		var i;
		var targetImgH = targetImg.height();
		for(i = 5; i <= targetWrpSize; i++) {
			targetWrp.eq(i).css('height', targetImgH);
		}
	};
	
	function loaderPos() {
		var winHeight = $(window).height();
		var halfWinH = winHeight / 2; 
		var docHeight = $(document).height();
		var scrollPosY = $(window).scrollTop();
		var result = docHeight - (scrollPosY + halfWinH);
		
		loader.css({
			'position' : 'absolute',
			'left' : '50%',
			'margin-left' : '-20px',
			'top' : result
		});
		
		$(window).on("mousewheel.disableScroll DOMMouseScroll.disableScroll touchmove.disableScroll", function(e) {
			e.preventDefault();
			return;
		});
		
		$('.dimmedBgWrp').show();
		$('.ajax_loader').show();
	}
	
	loaderPos();	
	
	viewAction(currentPage, unit);
	
	$(window).bind("scroll", function () {
		var docHeight = $(document).height(),
		winHeight = $(window).height(),
		triggerGap = parseInt(docHeight - winHeight) * sensitive;
		
		scrollPosY = $(window).scrollTop();
		
		if(triggerGap <= scrollPosY){
			if(isAvailable){
				if(!operation) {
					operation = true;
					viewAction(currentPage, unit);	
				}	
			}
		}
	});
	
	$(window).on('load', function() {
		$('.ajax_loader').hide();
		viewingInfoShow();
	});
	
	setTimeout(function() {
		viewingInfoHide();	
	}, 3000);
	
	$('.dimmedBgWrp, .viewingInfo').on('touchstart click', function() {
		$('.dimmedBgWrp').hide();
		$('.dimmedContentPos').hide();
		$('.viewingInfo').hide();
		$(window).off(".disableScroll");
	});
	
	function viewingInfoShow() {
		$('.viewingInfo').show();
	}
	
	function viewingInfoHide() {
		$('.dimmedBgWrp').hide();
		$('.viewingInfo').hide();
		$(window).off(".disableScroll");
	}
	
}());
</script>


